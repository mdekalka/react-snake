(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(10),i=n.n(a),o=(n(18),n(3)),s=n(4),l=n(2),u=(n(19),n(0)),d=function(e){var t=e.position;return Object(u.jsx)("div",{className:"loading-spinner",style:Object(s.a)({},t)})};d.defaultProps={position:{left:25,top:25}};n(21);function h(e){var t=e.cell,n=e.foodCells,c=e.wallCells,r=e.snake,a=e.direction,i="cell";return n.includes(t)&&(i+=" food-cell"),r.cells.includes(t)&&(i+=" snake-cell"),r.head.cell===t&&(i+=" head ".concat(a)),c.includes(t)&&(i+=" wall-cell"),i}var f=function(e){var t=e.board,n=e.foodCells,c=e.snake,r=e.direction,a=e.wallCells,i=e.invisibleWalls;return Object(u.jsx)("div",{className:"board ".concat(i?"no-borders":""),children:t.map((function(e,t){return Object(u.jsx)("div",{className:"row",children:e.map((function(e,t){return Object(u.jsx)("div",{className:h({cell:e,foodCells:n,wallCells:a,snake:c,direction:r}),children:Object(u.jsx)("div",{className:"cell-content"})},t)}))},t)}))})};f.defaultProps={board:[],foodCells:[],snake:{},direction:""};n(22);var j=function(e){var t=e.score,n=e.speed,r=e.onGameStart;return Object(c.useEffect)((function(){function e(e){"Enter"===e.code&&r()}return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[r]),Object(u.jsxs)("div",{className:"game-over",onClick:r,children:[Object(u.jsx)("h4",{className:"header",children:"You died..."}),Object(u.jsxs)("p",{className:"text",children:["Current score: ",t]}),Object(u.jsxs)("p",{className:"text",children:["Current speed: ",n]}),Object(u.jsxs)("p",{className:"text",children:["Press ",Object(u.jsx)("span",{className:"highlight",children:"Enter"})," or click ",Object(u.jsx)("span",{className:"highlight",children:"overlay"})," to start new game."]})]})};j.defaultProps={score:null,speed:null,onGameStart:function(){}};n(23);var b=function(e){var t=e.children;return Object(u.jsx)("div",{className:"information-board",children:t})},p=function(e){var t=e.children;return Object(u.jsx)("div",{className:"information-section",children:t})},v={header:{tag:"h4",class:"header"},text:{tag:"p",class:"text"},meta:{tag:"span",class:"meta"}},O=function(e){var t=e.type,n=e.sign,c=e.highlight,r=e.children,a=v[t]||v.text,i=a.tag,o=a.class;return Object(u.jsx)(i,{className:"information-typography ".concat(o," ").concat(n," ").concat(c?"highlight":""),children:r})};O.defaultProps={type:"text",sign:"",highlight:!1,children:null};var g=[{id:"#1",name:"speedRecovery",description:"Recovers speed to original start value.",icon:"\u2708",quality:"positive"},{id:"#2",name:"foodRain",description:"Generates multiple food cells across the board.",icon:"\u2735",quality:"positive"},{id:"#3",name:"noBorders",description:"Allow snake to go through borders w/o damage.",icon:"\u21b9",quality:"positive",interactWith:"$8"},{id:"#4",name:"normalControl",description:"Arrow controls become normal.",icon:"\u2194",quality:"positive",allowedAfter:"#7"},{id:"#5",name:"wallRain",description:"Generates multiple walls across the board.",icon:"\u2632",quality:"negative"},{id:"#6",name:"speedBoost",description:"Significantly increase speed.",icon:"\u27a2",quality:"negative"},{id:"#7",name:"reverseControl",description:"Arrow controls become reversed.",icon:"\u292e",quality:"negative",interactWith:"#4"},{id:"#8",name:"borders",description:"Moving through borders not allowed.",icon:"\u219b",quality:"negative",allowedAfter:"#3"}],m=n(9),x=n.n(m),w=n(11),y=n(12),S=n(13),C={Food:{name:"Food",path:n.p+"static/media/food.6b885d08.wav",repeat:!1},GameOver:{name:"GameOver",path:n.p+"static/media/game-over.9c7e6571.mp3",repeat:!1},MainTheme:{name:"MainTheme",path:n.p+"static/media/main-theme.995bbada.mp3",repeat:!0}},k=new(function(){function e(t){Object(y.a)(this,e),this.DEFAULT_AUDIO_LEVEL=.15,this.loading=null,this.listenCallback=function(){},this.sounds=t,this.audioContext=null,this.audioBuffers={},this.currentPlayingAudio=null,this.init()}return Object(S.a)(e,[{key:"init",value:function(){try{this.audioContext=new AudioContext}catch(e){console.error("Audio context is not suppoorted by browser: ",e.message)}this.audioContext&&this.loadSounds()}},{key:"loadSounds",value:function(){var e=this;this.loading=!0,this.listenCallback(this.loading),Promise.all(Object.values(this.sounds).map((function(t){return e.fetchSound(t)}))).finally((function(t){e.loading=!1,e.listenCallback(e.loading)}))}},{key:"onStateUpdate",value:function(e){this.listenCallback=e,this.listenCallback(this.loading)}},{key:"fetchSound",value:function(){var e=Object(w.a)(x.a.mark((function e(t){var n,c,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t.path);case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("Fetch http error: ".concat(n.status));case 6:return e.next=8,n.arrayBuffer();case 8:return c=e.sent,e.next=11,this.audioContext.decodeAudioData(c);case 11:r=e.sent,this.audioBuffers[t.name]=r,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Fetching or decoding audio files failed with: ",e.t0.message);case 18:case"end":return e.stop()}}),e,this,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"play",value:function(e){if(e){var t=e.name,n=this.audioBuffers[t],c=this.sounds[t];if(n){var r=this.audioContext.createBufferSource(),a=this.audioContext.createGain();a.gain.value=this.DEFAULT_AUDIO_LEVEL,a.connect(this.audioContext.destination),r.buffer=n,r.loop=c.repeat,r.connect(a),r.loop&&(this.stop(),this.currentPlayingAudio=r),r.start(0)}}}},{key:"pause",value:function(){this.currentPlayingAudio&&this.currentPlayingAudio.pause()}},{key:"stop",value:function(){this.currentPlayingAudio&&this.currentPlayingAudio.stop()}}]),e}())(C);var E=14,A=35,N=1,P=490,F=150,L=2,B=2,R=[],W=!1,M=!1;function q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=Math.floor(Math.random()*(t-e)+e);return n.includes(c)&&c++,c}function I(e,t,n){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=[];return new Array(n).fill(0).forEach((function(n){var a=q(e,t,[].concat(Object(o.a)(c),r));r.push(a)})),r}var G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return e.reduce((function(e,n){return e[t]||(e[n[t]]=n),e}),{})}(g,"id"),T=Object.keys(G);function D(){return g.filter((function(e){return e.allowedAfter})).map((function(e){return e.id}))}function U(e){return 5-e%5}var J=function(e){var t=e.score,n=e.snake,r=e.setSnakeSpeed,a=e.foodCells,i=e.setFoodCells,u=e.wallCells,d=e.setWallCells,h=e.setInsivibleWalls,f=e.setReverseControl,j=Object(c.useState)(null),b=Object(l.a)(j,2),p=b[0],v=b[1],O=Object(c.useState)(D),g=Object(l.a)(O,2),m=g[0],x=g[1];return Object(c.useEffect)((function(){if(0===t)return v(null),void x(D);if(5===U(t)){var e=function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e[Math.floor(Math.random()*e.length)]}(function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(t){return!e.includes(t)}))}(T,m)),t=G[e];t.interactWith&&(m.includes(t.interactWith)?x(m.filter((function(e){return e!==t.interactWith}))):x([].concat(Object(o.a)(m),[t.interactWith])));return t}();e&&(v(Object(s.a)({},e)),function(e){switch(e.name){case"speedRecovery":return void r(F);case"foodRain":var t=I(N,P,5,[].concat(Object(o.a)(n.cells),Object(o.a)(a)));return void i([].concat(Object(o.a)(t),Object(o.a)(a)));case"noBorders":return void h(!0);case"wallRain":var c=I(N,P,5,[].concat(Object(o.a)(n.cells),Object(o.a)(a),Object(o.a)(u)));return void d([].concat(Object(o.a)(u),Object(o.a)(c)));case"speedBoost":return void r((function(e){return e-20}));case"normalControl":return void f(!1);case"reverseControl":return void f(!0);case"borders":return void h(!1);default:;}}(e))}}),[t]),p},_=function(e){var t=e.score,n=e.snakeSpeed,c=e.stats;return Object(u.jsxs)(b,{children:[Object(u.jsxs)(p,{children:[Object(u.jsx)(O,{type:"header",children:"Statistics:"}),Object(u.jsxs)(O,{type:"text",children:["Curent score: ",t]}),Object(u.jsxs)(O,{type:"text",children:["Current speed: ",n]}),Object(u.jsx)("hr",{}),Object(u.jsxs)(O,{type:"text",children:["Hightest score: ",c.highestScore]}),Object(u.jsxs)(O,{type:"text",children:["Hightest speed: ",c.highestSpeed]}),Object(u.jsx)("hr",{}),Object(u.jsxs)(O,{children:["You need to get ",Object(u.jsx)(O,{type:"meta",highlight:!0,children:U(t)})," points to generate next effect."]})]}),Object(u.jsxs)(p,{children:[Object(u.jsx)(O,{type:"header",children:"Controls:"}),Object(u.jsxs)(O,{type:"text",children:[Object(u.jsx)(O,{type:"meta",highlight:!0,children:"\u2191"})," - to move up"]}),Object(u.jsxs)(O,{type:"text",children:[Object(u.jsx)(O,{type:"meta",highlight:!0,children:"\u2192"})," - to move right"]}),Object(u.jsxs)(O,{type:"text",children:[Object(u.jsx)(O,{type:"meta",highlight:!0,children:"\u2193"})," - to move down"]}),Object(u.jsxs)(O,{type:"text",children:[Object(u.jsx)(O,{type:"meta",highlight:!0,children:"\u2190"})," - to move left"]})]}),Object(u.jsxs)(p,{children:[Object(u.jsx)(O,{type:"header",children:"Board effects:"}),g.map((function(e){var t=e.id,n=e.quality,c=e.icon,r=e.description;return Object(u.jsxs)(O,{type:"text",children:[Object(u.jsx)(O,{sign:n,type:"meta",children:c}),"  - ",r]},t)}))]})]})};_.defaultProps={score:0,snakeSpeed:0,stats:{}};n(25);var H=function(e){var t=e.effect,n=e.delay,r=Object(c.useState)(!0),a=Object(l.a)(r,2),i=a[0],o=a[1];return Object(c.useEffect)((function(){var e=null;function c(){e&&(clearTimeout(e),e=null)}return o(!0),t&&(e=setTimeout((function(){o(!1),c()}),n)),function(){c()}}),[t,n]),i&&t?Object(u.jsx)("div",{className:"notification",children:Object(u.jsxs)(O,{type:"text",children:[Object(u.jsx)(O,{type:"meta",sign:t.quality,children:t.icon}),"  - ",t.description]})}):null};function V(e,t){return e.includes(t)}function Y(e,t,n){return e[t][n]}function $(e,t){var n=function(e,t){var n=e.length,c=e[0].length,r=Math.round(n/(e.length/t)),a=Math.round(c/(e.length/t));return{row:r,col:a,cell:Y(e,r,a)}}(e,t);return{head:n,tail:n,cells:[n.cell]}}H.defaultProps={delay:2e3,effect:null};var z,K=n(5),Q="up",X="right",Z="down",ee="left",te=(z={},Object(K.a)(z,Q,Z),Object(K.a)(z,X,ee),Object(K.a)(z,Z,Q),Object(K.a)(z,ee,X),z);function ne(e){return te[e]}n(26);var ce=function(e,t){for(var n=1,c=[],r=0;r<e;r++){for(var a=[],i=0;i<t;i++)a.push(n++);c.push(a)}return c}(E,A),re=$(ce,B),ae=q(re.head.cell,P,[re.head.cell]),ie=function(){var e=Object(c.useState)(re),t=Object(l.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(F),i=Object(l.a)(a,2),h=i[0],b=i[1],p=Object(c.useState)([ae]),v=Object(l.a)(p,2),O=v[0],g=v[1],m=Object(c.useState)(null),x=Object(l.a)(m,2),w=x[0],y=x[1],S=Object(c.useRef)(w),C=function(e,t){var n=Object(c.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return console.log(c),t}})),r=Object(l.a)(n,2),a=r[0],i=r[1];return[a,function(t){try{var n=t instanceof Function?t(a):t;i(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(c){console.log(c)}}]}("highest-stats",{highestScore:0,highestSpeed:F}),E=Object(l.a)(C,2),A=E[0],I=E[1],G=Object(c.useState)(0),T=Object(l.a)(G,2),D=T[0],U=T[1],z=Object(c.useState)(!1),K=Object(l.a)(z,2),te=K[0],ie=K[1],oe=Object(c.useState)(!1),se=Object(l.a)(oe,2),le=se[0],ue=se[1],de=function(e){var t=Object(c.useState)(null),n=Object(l.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(!1),o=Object(l.a)(i,2),s=o[0],u=o[1];Object(c.useEffect)((function(){k.onStateUpdate((function(e){a(e)}))}),[]),Object(c.useEffect)((function(){u(e),e||k.stop()}),[e]);var d=Object(c.useCallback)((function(e){s&&k.play(e)}),[s]);return{loading:r,sounds:k.sounds,play:d}}(le),he=de.loading,fe=de.play,je=de.sounds,be=Object(c.useState)(R),pe=Object(l.a)(be,2),ve=pe[0],Oe=pe[1],ge=Object(c.useState)(W),me=Object(l.a)(ge,2),xe=me[0],we=me[1],ye=Object(c.useState)(M),Se=Object(l.a)(ye,2),Ce=Se[0],ke=Se[1],Ee=J({score:D,snake:n,snakeSpeed:h,setSnakeSpeed:b,foodCells:O,setFoodCells:g,wallCells:ve,setWallCells:Oe,setInsivibleWalls:we,setReverseControl:ke}),Ae=Object(c.useCallback)((function(){var e=D>A.highestScore,t=h<A.highestSpeed,n=Object(s.a)(Object(s.a)({},e&&{highestScore:D}),t&&{highestSpeed:h});I((function(e){return Object(s.a)(Object(s.a)({},e),n)}))}),[D,h,A,I]),Ne=Object(c.useCallback)((function(){var e=$(ce,B),t=q(e.head.cell,P,[e.head.cell]);Ae(),S.current=null,we(W),ke(M),ie(!1),r(e),g([t]),Oe(R),y(null),U(0),b(F)}),[Ae]);return Object(c.useEffect)((function(){fe(je.MainTheme)}),[fe,je]),Object(c.useEffect)((function(){te&&fe(je.GameOver)}),[te,fe,je]),Object(c.useEffect)((function(){function e(e){if(!te){var t=function(e){switch(e){case"ArrowLeft":return ee;case"ArrowUp":return Q;case"ArrowRight":return X;case"ArrowDown":return Z;default:return""}}(e.code);""!==t&&(Ce&&(t=ne(t)),S.current=t)}}return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[te,Ce]),function(e,t){var n=Object(c.useRef)();Object(c.useEffect)((function(){n.current=e}),[e]),Object(c.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){if(S.current){var e=function(e,t){return ne(e)===t}(w,S.current)?w:S.current,t=function(e,t){var n=e.row,c=e.col;switch(t){case Q:return{row:n-1,col:c};case X:return{row:n,col:c+1};case Z:return{row:n+1,col:c};case ee:return{row:n,col:c-1};default:return null}}(n.head,e);if(function(e,t){var n=e.row,c=e.col;return n<0||c<0||n>=t.length||c>=t[0].length}(t,ce)){if(!xe)return ie(!0);t=function(e,t,n){var c=e.row,r=e.col;switch(n){case Q:return{row:t.length-1,col:r};case X:return{row:c,col:0};case Z:return{row:0,col:r};case ee:return{row:c,col:t[0].length-1};default:return null}}(t,ce,e)}var c=Y(ce,t.row,t.col),a=Object(s.a)(Object(s.a)({},t),{},{cell:c}),i=[];if(V(n.cells,a.cell))return ie(!0);if(V(ve,a.cell))return ie(!0);O.includes(c)?(function(e){var t=q(N,P,e),n=O.filter((function(t){return!e.includes(t)}));g([].concat(Object(o.a)(n),[t]))}(i=[].concat(Object(o.a)(n.cells),[c])),b((function(e){return e-L})),U((function(e){return e+1})),fe(je.Food)):((i=Object(o.a)(n.cells)).shift(),i.push(a.cell));var l=function(e,t){for(var n=0;n<e.length;n++)for(var c=0;c<e.length;c++)if(e[n][c]===t)return{row:n,col:c,cell:t}}(ce,i[0]);y(e),r({head:a,tail:l,cells:i})}}),te?null:h),Object(u.jsxs)("div",{className:"game-wrapper",children:[he?Object(u.jsx)(d,{position:{top:25,right:25}}):Object(u.jsx)("div",{className:"sound-control ".concat(le?"on":""),title:"audio toggle",onClick:function(){ue((function(e){return!e}))},children:"\u266c"}),Object(u.jsx)(H,{effect:Ee,delay:5e3}),Object(u.jsxs)("div",{className:"board-wrapper",children:[Object(u.jsx)(f,{board:ce,foodCells:O,wallCells:ve,snake:n,direction:w,invisibleWalls:xe}),te&&Object(u.jsx)(j,{score:D,speed:h,onGameStart:Ne})]}),Object(u.jsx)(_,{score:D,snakeSpeed:h,stats:A})]})};n(27);var oe=function(){return Object(u.jsx)(ie,{})},se=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,29)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(u.jsxs)(r.a.StrictMode,{children:[Object(u.jsx)(oe,{}),","]}),document.getElementById("root")),se()}},[[28,1,2]]]);
//# sourceMappingURL=main.3a1fb836.chunk.js.map